return(DCL_calc)
}
total_DCL <- function(dados) {
DCL_calc <- dados %>%
filter(Conta %in% c("DÍVIDA CONSOLIDADA - DC (I)", Coluna == "Até o 3º Quadrimestre")) %>%
group_by(Escopo) %>%
summarise(DC = sum(Valor))
return(DCL_calc)
}
View(total_DCL)
total_DCL <- function(dados) {
DCL_calc <- dados %>%
filter(Conta %in% c("DÍVIDA CONSOLIDADA - DC (I)", Coluna == "Até o 3º Quadrimestre")) %>%
group_by(Escopo) %>%
summarise(DC = sum(Valor))
}
total_DCL <- function(dados) {
dados %>%
filter(Conta %in% c("DÍVIDA CONSOLIDADA - DC (I)", Coluna == "Até o 3º Quadrimestre")) %>%
group_by(Escopo) %>%
summarise(DC = sum(Valor))
}
total_DCL <- function(dados) {
dados %>%
filter(Conta == "DÍVIDA CONSOLIDADA - DC (I)", Coluna == "Até o 3º Quadrimestre") %>%
group_by(Escopo) %>%
summarise(DC = sum(Valor))
}
total_DCL <- function(dados) {
dados %>%
filter(Conta == "DÍVIDA CONSOLIDADA - DC (I)" & Coluna == "Até o 3º Quadrimestre") %>%
group_by(Escopo) %>%
summarise(DC = sum(Valor))
}
total_DCL <- function(tabelinhas) {
tabelinhas %>%
filter(Conta == "DÍVIDA CONSOLIDADA - DC (I)" & Coluna == "Até o 3º Quadrimestre") %>%
group_by(Escopo) %>%
summarise(DC = sum(Valor))
}
total_DCL <- function(tabelinhas) {
tabelinhas %>%
filter(Conta == "DÍVIDA CONSOLIDADA - DC (I)" & Coluna == "Até o 3º Quadrimestre") %>%
group_by(Escopo) %>%
summarise(DC = sum(Valor))
}
totalDCL <- function(tabelinhas) {
tabelinhas %>%
filter(Conta == "DÍVIDA CONSOLIDADA - DC (I)" & Coluna == "Até o 3º Quadrimestre") %>%
group_by(Escopo) %>%
summarise(DC = sum(Valor))
}
tabelas <- list(tabela_municipios, tabela_estados, tabela_uniao)
result <- lapply(tabelas, total_DCL())
result <- lapply(tabelas, totalDCL)
DCLs_entes <- bind_rows(result)
View(DCLs_entes)
View(pop_UFs)
pop_brasil <- sum(pop_UFs["pop"])
pop_brasil
DCLs_entes <- DCLs_entes %>% mutate(DC_pop = DC / pop_brasil)
# dados uniao
tabela_uniao <- read.csv2("./dados/finbraRGF_uniao.csv", skip = 5) %>%
mutate(Escopo    = "Uniao",
Exercicio = 2018)
save(list = c("tabela_estados", "tabela_uniao", "tabela_mun1", "tabela_mun2", "perfil_mun"), file = "dados.RData")
totalDCL <- function(tabelinhas) {
tabelinhas %>%
filter(Conta == "DÍVIDA CONSOLIDADA - DC (I)" & Coluna == "Até o 3º Quadrimestre") %>%
group_by(Escopo) %>%
summarise(DC = sum(Valor))
}
tabelas <- list(tabela_municipios, tabela_estados, tabela_uniao)
result <- lapply(tabelas, totalDCL)
DCLs_entes <- bind_rows(result)
DCLs_entes <- DCLs_entes %>% mutate(DC_pop = DC / pop_brasil)
scale_fill_manual(values = tres_cores) +
scale_color_manual(values = tres_cores) +
coord_flip() +
tema()
ggplot(DCLs_entes, aes(y = DC, x = Escopo, fill = Escopo, color = Escopo)) +
geom_col() +
geom_text(aes(y = DC + 1e9, label = paste0(
format(round(DC/1e9,0), big.mark = ".", decimal.mark = ","),
" bi")), family = "Open Sans") +
scale_fill_manual(values = tres_cores) +
scale_color_manual(values = tres_cores) +
coord_flip() +
tema()
ggplot(total_DCL, aes(y = UF, color = Escopo, x = DCL_percent)) +
geom_vline(xintercept = 2, linetype = 'dotted') +
geom_path(color = "lightgrey", size = 1.5) +
geom_point(size = 3) +
geom_text(aes(x = ifelse(Estado_Maior,
ifelse(Escopo == "Estados",
DCL_percent + 0.18,
DCL_percent - 0.15),
ifelse(Escopo == "Estados",
DCL_percent - 0.15,
DCL_percent + 0.18)),
label = percent(DCL_percent)), family = "Open Sans", size = 3) +
annotate(geom = "text", x = 2.01, y = 16, label = "Limite definido \npelo Senado Federal",
family = "Open Sans", color = "dimgrey", size = 2.5, hjust = "left") +
scale_x_continuous(labels = percent) +
scale_color_manual(values = c("Estados" = tres_cores[1], "Municípios" = tres_cores[2])) +
labs(x = "Percentual DCL/RCL",
y = NULL,
title = "Dívida Consolidada Líquida",
subtitle = "Estados e Municípios do Estado",
color = NULL) +
tema() + theme(legend.position = "top")
ggplot(total_DCL, aes(y = UF, color = Escopo, x = DCL_percent)) +
geom_vline(xintercept = 2, linetype = 'dotted') +
geom_path(color = "lightgrey", size = 1.5) +
geom_point(size = 3) +
geom_text(aes(x = ifelse(Estado_Maior,
ifelse(Escopo == "Estados",
DCL_percent + 0.18,
DCL_percent - 0.15),
ifelse(Escopo == "Estados",
DCL_percent - 0.15,
DCL_percent + 0.18)),
label = percent(DCL_percent)), family = "Open Sans", size = 3) +
annotate(geom = "text", x = 2.01, y = 16, label = "Limite definido \npelo Senado Federal",
family = "Open Sans", color = "dimgrey", size = 2.5, hjust = "left") +
scale_x_continuous(labels = percent) +
scale_color_manual(values = c("Estados" = tres_cores[1], "Municípios" = tres_cores[2])) +
labs(x = "Percentual DCL/RCL",
y = NULL,
title = "Dívida Consolidada Líquida",
subtitle = "Estados e Municípios do Estado",
color = NULL) +
tema() + theme(legend.position = "top")
total_DCL
total_DCL <- tabela_completa %>%
filter(Conta %in% c("DÍVIDA CONSOLIDADA LÍQUIDA (DCL) (III) = (I - II)",
"RECEITA CORRENTE LÍQUIDA - RCL")) %>%
filter(Coluna == "Até o 3º Quadrimestre") %>%
mutate(Conta = case_when(Conta == "DÍVIDA CONSOLIDADA LÍQUIDA (DCL) (III) = (I - II)" ~ "DCL",
Conta == "RECEITA CORRENTE LÍQUIDA - RCL" ~ "RCL")) %>%
group_by(UF, REGIAO, Escopo, Conta) %>%
summarise(Valor = sum(Valor)) %>%
spread(Conta, value = Valor) %>%
ungroup() %>%
mutate(DCL_percent = round(DCL/RCL, 4),
UF = fct_reorder(UF, DCL_percent, first, .desc = FALSE)) # atenção ao first
total_DCL <- total_DCL %>%
select(UF, Escopo, DCL_percent) %>%
spread(Escopo, value = DCL_percent) %>%
mutate(Estado_Maior = Estados > `Municípios`,
Estado_Maior = replace_na(Estado_Maior, TRUE)) %>%
select(UF, Estado_Maior) %>%
right_join(total_DCL)
ggplot(total_DCL, aes(y = UF, color = Escopo, x = DCL_percent)) +
geom_vline(xintercept = 2, linetype = 'dotted') +
geom_path(color = "lightgrey", size = 1.5) +
geom_point(size = 3) +
geom_text(aes(x = ifelse(Estado_Maior,
ifelse(Escopo == "Estados",
DCL_percent + 0.18,
DCL_percent - 0.15),
ifelse(Escopo == "Estados",
DCL_percent - 0.15,
DCL_percent + 0.18)),
label = percent(DCL_percent)), family = "Open Sans", size = 3) +
annotate(geom = "text", x = 2.01, y = 16, label = "Limite definido \npelo Senado Federal",
family = "Open Sans", color = "dimgrey", size = 2.5, hjust = "left") +
scale_x_continuous(labels = percent) +
scale_color_manual(values = c("Estados" = tres_cores[1], "Municípios" = tres_cores[2])) +
labs(x = "Percentual DCL/RCL",
y = NULL,
title = "Dívida Consolidada Líquida",
subtitle = "Estados e Municípios do Estado",
color = NULL) +
tema() + theme(legend.position = "top")
ggplot(DCLs_entes, aes(y = DC, x = Escopo, fill = Escopo, color = Escopo)) +
geom_col() +
geom_text(aes(y = DC + 1e9, label = paste0(
format(round(DC/1e9,0), big.mark = ".", decimal.mark = ","),
" bi")), family = "Open Sans") +
scale_fill_manual(values = tres_cores) +
scale_color_manual(values = tres_cores) +
coord_flip() +
tema()
ggplot(DCLs_entes, aes(y = DC, x = reorder(Escopo, DC), fill = Escopo, color = Escopo)) +
geom_col() +
geom_text(aes(y = DC + 1e9, label = paste0(
format(round(DC/1e9,0), big.mark = ".", decimal.mark = ","),
" bi")), family = "Open Sans") +
scale_fill_manual(values = tres_cores) +
scale_color_manual(values = tres_cores) +
coord_flip() +
tema()
ggplot(DCLs_entes, aes(y = DC, x = reorder(Escopo, DC), fill = Escopo, color = Escopo)) +
geom_col() +
geom_text(aes(y = DC + 1e9, label = paste0(
format(round(DC/1e9,0), big.mark = ".", decimal.mark = ","),
" bi")), family = "Open Sans") +
scale_fill_manual(values = tres_cores) +
scale_color_manual(values = tres_cores) +
coord_flip() +
tema()
ggplot(DCLs_entes, aes(y = DC, x = reorder(Escopo, DC), fill = Escopo, color = Escopo)) +
geom_col() +
geom_text(aes(y = DC + 1e9, label = paste0(
format(round(DC/1e9,0), big.mark = ".", decimal.mark = ","),
" bi")), family = "Open Sans", hjust = "outward") +
scale_fill_manual(values = tres_cores) +
scale_color_manual(values = tres_cores) +
coord_flip() +
tema()
format(round(DC/1e9,0), big.mark = ".", decimal.mark = ","),
" bi")), family = "Open Sans", hjust = "inward") +
scale_fill_manual(values = tres_cores) +
scale_color_manual(values = tres_cores) +
coord_flip() +
tema()
ggplot(DCLs_entes, aes(y = DC, x = reorder(Escopo, DC), fill = Escopo, color = Escopo)) +
geom_col() +
geom_text(aes(y = DC + 1e9, label = paste0(
format(round(DC/1e9,0), big.mark = ".", decimal.mark = ","),
" bi")), family = "Open Sans", hjust = "inward") +
scale_fill_manual(values = tres_cores) +
scale_color_manual(values = tres_cores) +
coord_flip() +
tema()
format(round(DC/1e9,0), big.mark = ".", decimal.mark = ","),
" bi")), family = "Open Sans", hjust = "inward") +
scale_fill_manual(values = tres_cores) +
scale_color_manual(values = tres_cores) +
scale_y_continuous(labels=function(x) {format(x/1e9, big.mark = ".", decimal.mark=",", scientific = FALSE)}) +
coord_flip() +
tema()
ggplot(DCLs_entes, aes(y = DC, x = reorder(Escopo, DC), fill = Escopo, color = Escopo)) +
geom_col() +
geom_text(aes(y = DC + 1e9, label = paste0(
format(round(DC/1e9,0), big.mark = ".", decimal.mark = ","),
" bi")), family = "Open Sans", hjust = "inward") +
scale_fill_manual(values = tres_cores) +
scale_color_manual(values = tres_cores) +
scale_y_continuous(labels=function(x) {format(x/1e9, big.mark = ".", decimal.mark=",", scientific = FALSE)}) +
coord_flip() +
tema()
format(round(DC/1e9,0), big.mark = ".", decimal.mark = ","),
" bi")), family = "Open Sans", hjust = "inward") +
scale_fill_manual(values = tres_cores) +
scale_color_manual(values = tres_cores) +
scale_y_continuous(labels=function(x) {format(x/1e9, big.mark = ".", decimal.mark=",", scientific = FALSE)}, expand = c(NA, max(DCLs_entes$DC * 1.1))) +
coord_flip() +
tema()
ggplot(DCLs_entes, aes(y = DC, x = reorder(Escopo, DC), fill = Escopo, color = Escopo)) +
geom_col() +
geom_text(aes(y = DC + 1e9, label = paste0(
format(round(DC/1e9,0), big.mark = ".", decimal.mark = ","),
" bi")), family = "Open Sans", hjust = "inward") +
scale_fill_manual(values = tres_cores) +
scale_color_manual(values = tres_cores) +
scale_y_continuous(labels=function(x) {format(x/1e9, big.mark = ".", decimal.mark=",", scientific = FALSE)}, expand = c(NA, max(DCLs_entes$DC * 1.1))) +
coord_flip() +
tema()
ggplot(DCLs_entes, aes(y = DC, x = reorder(Escopo, DC), fill = Escopo, color = Escopo)) +
geom_col() +
geom_text(aes(y = DC + 1e9, label = paste0(
format(round(DC/1e9,0), big.mark = ".", decimal.mark = ","),
" bi")), family = "Open Sans", hjust = "inward") +
scale_fill_manual(values = tres_cores) +
scale_color_manual(values = tres_cores) +
scale_y_continuous(labels=function(x) {format(x/1e9, big.mark = ".", decimal.mark=",", scientific = FALSE)}) +
expand_limits(c(NA, max(DCLs_entes$DC * 1.1))) +
coord_flip() +
tema()
ggplot(DCLs_entes, aes(y = DC, x = reorder(Escopo, DC), fill = Escopo, color = Escopo)) +
geom_col() +
geom_text(aes(y = DC + 1e9, label = paste0(
format(round(DC/1e9,0), big.mark = ".", decimal.mark = ","),
" bi")), family = "Open Sans", hjust = "inward") +
scale_fill_manual(values = tres_cores) +
scale_color_manual(values = tres_cores) +
scale_y_continuous(labels=function(x) {format(x/1e9, big.mark = ".", decimal.mark=",", scientific = FALSE)}) +
expand_limits(c(NA, max(DCLs_entes$DC * 1.2))) +
coord_flip() +
tema()
ggplot(DCLs_entes, aes(y = DC, x = reorder(Escopo, DC), fill = Escopo, color = Escopo)) +
geom_col() +
geom_text(aes(y = DC + 1e9, label = paste0(
format(round(DC/1e9,0), big.mark = ".", decimal.mark = ","),
" bi")), family = "Open Sans", hjust = "inward") +
scale_fill_manual(values = tres_cores) +
scale_color_manual(values = tres_cores) +
scale_y_continuous(labels=function(x) {format(x/1e9, big.mark = ".", decimal.mark=",", scientific = FALSE)}) +
expand_limits(y = max(DCLs_entes$DC * 1.2)) +
coord_flip() +
tema()
ggplot(DCLs_entes, aes(y = DC, x = reorder(Escopo, DC), fill = Escopo, color = Escopo)) +
geom_col() +
geom_text(aes(y = DC + 1e9, label = paste0(
format(round(DC/1e9,0), big.mark = ".", decimal.mark = ","),
" bi")), family = "Open Sans", hjust = "inward") +
scale_fill_manual(values = tres_cores) +
scale_color_manual(values = tres_cores) +
scale_y_continuous(labels=function(x) {format(x/1e9, big.mark = ".", decimal.mark=",", scientific = FALSE)}) +
expand_limits(y = max(DCLs_entes$DC * 1.5)) +
coord_flip() +
tema()
ggplot(DCLs_entes, aes(y = DC, x = reorder(Escopo, DC), fill = Escopo, color = Escopo)) +
geom_col() +
geom_text(aes(y = DC + 1e9, label = paste0(
format(round(DC/1e9,0), big.mark = ".", decimal.mark = ","),
" bi")), family = "Open Sans", hjust = "left") +
scale_fill_manual(values = tres_cores) +
scale_color_manual(values = tres_cores) +
scale_y_continuous(labels=function(x) {format(x/1e9, big.mark = ".", decimal.mark=",", scientific = FALSE)}) +
expand_limits(y = max(DCLs_entes$DC * 1.5)) +
coord_flip() +
tema()
ggplot(DCLs_entes, aes(y = DC, x = reorder(Escopo, DC), fill = Escopo, color = Escopo)) +
geom_col() +
geom_text(aes(y = DC + 5e9, label = paste0(
format(round(DC/1e9,0), big.mark = ".", decimal.mark = ","),
" bi")), family = "Open Sans", hjust = "left") +
scale_fill_manual(values = tres_cores) +
scale_color_manual(values = tres_cores) +
scale_y_continuous(labels=function(x) {format(x/1e9, big.mark = ".", decimal.mark=",", scientific = FALSE)}) +
expand_limits(y = max(DCLs_entes$DC * 1.5)) +
coord_flip() +
tema()
ggplot(DCLs_entes, aes(y = DC, x = reorder(Escopo, DC), fill = Escopo, color = Escopo)) +
geom_col() +
geom_text(aes(y = DC + 5e9, label = paste0(
format(round(DC/1e9,0), big.mark = ".", decimal.mark = ","),
" bi")), family = "Open Sans", hjust = "left") +
scale_fill_manual(values = tres_cores) +
scale_color_manual(values = tres_cores) +
scale_y_continuous(labels=function(x) {format(x/1e9, big.mark = ".", decimal.mark=",", scientific = FALSE)}) +
expand_limits(y = max(DCLs_entes$DC * 1.5)) +
coord_flip() +
tema()
ggplot(DCLs_entes, aes(y = DC, x = reorder(Escopo, DC), fill = Escopo, color = Escopo)) +
geom_col() +
geom_text(aes(y = DC + 10e9, label = paste0(
format(round(DC/1e9,0), big.mark = ".", decimal.mark = ","),
" bi")), family = "Open Sans", hjust = "left") +
scale_fill_manual(values = tres_cores) +
scale_color_manual(values = tres_cores) +
scale_y_continuous(labels=function(x) {format(x/1e9, big.mark = ".", decimal.mark=",", scientific = FALSE)}) +
expand_limits(y = max(DCLs_entes$DC * 1.5)) +
coord_flip() +
tema()
ggplot(DCLs_entes, aes(y = DC, x = reorder(Escopo, DC), fill = Escopo, color = Escopo)) +
geom_col() +
geom_text(aes(y = DC + 1e10, label = paste0(
format(round(DC/1e9,0), big.mark = ".", decimal.mark = ","),
" bi")), family = "Open Sans", hjust = "left") +
scale_fill_manual(values = tres_cores) +
scale_color_manual(values = tres_cores) +
scale_y_continuous(labels=function(x) {format(x/1e9, big.mark = ".", decimal.mark=",", scientific = FALSE)}) +
expand_limits(y = max(DCLs_entes$DC * 1.5)) +
coord_flip() +
tema()
ggplot(DCLs_entes, aes(y = DC, x = reorder(Escopo, DC), fill = Escopo, color = Escopo)) +
geom_col() +
geom_text(aes(y = DC + 1e11, label = paste0(
format(round(DC/1e9,0), big.mark = ".", decimal.mark = ","),
" bi")), family = "Open Sans", hjust = "left") +
scale_fill_manual(values = tres_cores) +
scale_color_manual(values = tres_cores) +
scale_y_continuous(labels=function(x) {format(x/1e9, big.mark = ".", decimal.mark=",", scientific = FALSE)}) +
expand_limits(y = max(DCLs_entes$DC * 1.5)) +
coord_flip() +
tema()
ggplot(DCLs_entes, aes(y = DC, x = reorder(Escopo, DC), fill = Escopo, color = Escopo)) +
geom_col() +
geom_text(aes(y = DC + 1e11, label = paste0(
format(round(DC/1e9,0), big.mark = ".", decimal.mark = ","),
" bi")), family = "Open Sans", hjust = "left") +
scale_fill_manual(values = tres_cores) +
scale_color_manual(values = tres_cores) +
scale_y_continuous(labels=function(x) {format(x/1e9, big.mark = ".", decimal.mark=",", scientific = FALSE)}) +
expand_limits(y = max(DCLs_entes$DC * 1.2)) +
coord_flip() +
tema()
ggplot(DCLs_entes, aes(y = DC, x = reorder(Escopo, DC), fill = Escopo, color = Escopo)) +
geom_col() +
geom_text(aes(y = DC + 1e11, label = paste0(
format(round(DC/1e9,0), big.mark = ".", decimal.mark = ","),
" bi")), family = "Open Sans", hjust = "left") +
scale_fill_manual(values = tres_cores) +
scale_color_manual(values = tres_cores) +
scale_y_continuous(labels=function(x) {format(x/1e9, big.mark = ".", decimal.mark=",", scientific = FALSE)}) +
expand_limits(y = max(DCLs_entes$DC * 1.2)) +
labs(x = NULL, y = "R$ bi", title = "Dívida Consolidada dos níveis de Governo",
subtitle = "Alguns estados e muitos municípios não estão incluídos")
ggplot(DCLs_entes, aes(y = DC, x = reorder(Escopo, DC), fill = Escopo, color = Escopo)) +
geom_col() +
geom_text(aes(y = DC + 1e11, label = paste0(
format(round(DC/1e9,0), big.mark = ".", decimal.mark = ","),
" bi")), family = "Open Sans", hjust = "left") +
scale_fill_manual(values = tres_cores) +
scale_color_manual(values = tres_cores) +
scale_y_continuous(labels=function(x) {format(x/1e9, big.mark = ".", decimal.mark=",", scientific = FALSE)}) +
expand_limits(y = max(DCLs_entes$DC * 1.2)) +
labs(x = NULL, y = "R$ bi", title = "Dívida Consolidada dos níveis de Governo",
subtitle = "Alguns estados e muitos municípios não estão incluídos") +
coord_flip() +
tema()
ggplot(DCLs_entes, aes(y = DC, x = reorder(Escopo, DC), fill = Escopo, color = Escopo)) +
ggplot(DCLs_entes, aes(y = DC, x = reorder(Escopo, DC), fill = Escopo, color = Escopo)) +
geom_col() +
geom_text(aes(y = DC + 1e11, label = paste0(
format(round(DC/1e9,0), big.mark = ".", decimal.mark = ","),
" bi")), family = "Open Sans", hjust = "left") +
scale_fill_manual(values = tres_cores) +
scale_color_manual(values = tres_cores) +
scale_y_continuous(labels=function(x) {format(x/1e9, big.mark = ".", decimal.mark=",", scientific = FALSE)}) +
expand_limits(y = max(DCLs_entes$DC * 1.2)) +
labs(x = NULL, y = "R$ bi", title = "Dívida Consolidada dos níveis de Governo",
subtitle = "Alguns estados e muitos municípios não estão incluídos (ver \"Abrangência\" logo mais") +
coord_flip() +
tema()
ggplot(DCLs_entes, aes(y = DC, x = reorder(Escopo, DC), fill = Escopo, color = Escopo)) +
geom_col() +
geom_text(aes(y = DC + 1e11, label = paste0(
format(round(DC/1e9,0), big.mark = ".", decimal.mark = ","),
" bi")), family = "Open Sans", hjust = "left") +
scale_fill_manual(values = tres_cores) +
scale_color_manual(values = tres_cores) +
scale_y_continuous(labels=function(x) {format(x/1e9, big.mark = ".", decimal.mark=",", scientific = FALSE)}) +
expand_limits(y = max(DCLs_entes$DC * 1.2)) +
labs(x = NULL, y = "R$ bi", title = "Dívida Consolidada dos níveis de Governo",
subtitle = "Alguns estados e muitos municípios não estão incluídos (ver \"Abrangência\" logo mais") +
coord_flip() +
tema()
ggplot(DCLs_entes, aes(y = DC, x = reorder(Escopo, DC), fill = Escopo, color = Escopo)) +
ggplot(DCLs_entes, aes(y = DC, x = reorder(Escopo, DC), fill = Escopo, color = Escopo)) +
geom_col() +
geom_text(aes(y = DC + 1e11, label = paste0(
format(round(DC/1e9,0), big.mark = ".", decimal.mark = ","),
" bi")), family = "Open Sans", hjust = "left") +
scale_fill_manual(values = tres_cores) +
scale_color_manual(values = tres_cores) +
scale_y_continuous(labels=function(x) {format(x/1e9, big.mark = ".", decimal.mark=",", scientific = FALSE)}) +
expand_limits(y = max(DCLs_entes$DC * 1.2)) +
labs(x = NULL, y = "R$ bi", title = "Dívida Consolidada dos níveis de Governo",
subtitle = "Alguns estados e muitos municípios não estão incluídos (ver \"Abrangência\" logo mais)") +
coord_flip() +
tema()
ggplot(DCLs_entes, aes(y = DC, x = reorder(Escopo, DC), fill = Escopo, color = Escopo)) +
geom_col() +
geom_text(aes(y = DC + 1e11, label = paste0(
format(round(DC/1e9,0), big.mark = ".", decimal.mark = ","),
" bi")), family = "Open Sans", hjust = "left", size = 3) +
scale_fill_manual(values = tres_cores) +
scale_color_manual(values = tres_cores) +
scale_y_continuous(labels=function(x) {format(x/1e9, big.mark = ".", decimal.mark=",", scientific = FALSE)}) +
expand_limits(y = max(DCLs_entes$DC * 1.2)) +
labs(x = NULL, y = "R$ bi", title = "Dívida Consolidada dos níveis de Governo",
subtitle = "Alguns estados e muitos municípios não estão incluídos (ver \"Abrangência\" logo mais)") +
coord_flip() +
tema()
ggplot(DCLs_entes, aes(y = DC, x = reorder(Escopo, DC), fill = Escopo, color = Escopo)) +
geom_col() +
geom_text(aes(y = DC + 1e11, label = paste0(
format(round(DC/1e9,0), big.mark = ".", decimal.mark = ","),
" bi")), family = "Open Sans", hjust = "left", size = 3.5) +
scale_fill_manual(values = tres_cores) +
scale_color_manual(values = tres_cores) +
scale_y_continuous(labels=function(x) {format(x/1e9, big.mark = ".", decimal.mark=",", scientific = FALSE)}) +
expand_limits(y = max(DCLs_entes$DC * 1.2)) +
labs(x = NULL, y = "R$ bi", title = "Dívida Consolidada dos níveis de Governo",
subtitle = "Alguns estados e muitos municípios não estão incluídos (ver \"Abrangência\" logo mais)") +
coord_flip() +
tema()
# bloco para resolver problemas do shiny
load("dados.RData")
names(tabela_mun1) <- c("Instituicao", "Cod.IBGE", "UF", "PODER", "Populacao", "Coluna",
"Conta", "Valor")
names(tabela_mun2) <- c("Instituicao", "Cod.IBGE", "UF", "PODER", "Populacao", "Coluna",
"Conta", "Valor")
names(tabela_uniao) <- c("Instituicao", "Cod.IBGE", "UF", "PODER", "Populacao", "Coluna",
"Conta", "Valor", "Escopo", "Exercicio")
names(tabela_estados) <- c("Instituicao", "Cod.IBGE", "UF", "PODER", "Populacao", "Coluna",
"Conta", "Valor", "Escopo", "Exercicio")
tabela_mun <- rbind(tabela_mun1, tabela_mun2) %>%
mutate(Escopo    = "Municípios",
Exercicio = 2018)
# testando população total para tabela estados
pop_total_est <- tabela_estados %>%
group_by(UF) %>%
summarise(pop = first(Populacao)) %>%
group_by() %>%
summarise(pop = sum(pop))
# população atualizada
pop_UFs <- perfil_mun %>%
group_by(UF, REGIAO) %>%
summarise(pop = sum(`POP EST`))
tabela_estados <- tabela_estados %>%
inner_join(pop_UFs) %>%
mutate(`CLASSE POP` = NA)
View(tabela_estados)
# população atualizada
pop_UFs <- perfil_mun %>%
group_by(UF, REGIAO) %>%
summarise(pop = sum(`POP EST`))
tabela_estados <- tabela_estados %>%
inner_join(pop_UFs) %>%
mutate(`CLASSE POP` = NA)
# bloco para resolver problemas do shiny
load("dados.RData")
tabela_estados <- read.csv2("./dados/finbraRGF_estados.csv", skip = 5) %>%
mutate(Escopo    = "Estados",
Exercicio = 2018)
save(list = c("tabela_estados", "tabela_uniao", "tabela_mun1", "tabela_mun2", "perfil_mun"), file = "dados.RData")
